# Исправление ошибки "null is not an object (evaluating 'p.length')"

## Проблема
Ошибка возникала из-за обращения к свойству `.length` на `null` или `undefined` значениях.

## Внесенные исправления

### 1. Защита массивов `movies` и `matches`
- Добавлены проверки `Array.isArray()` перед использованием массивов
- Все обращения к `.length` защищены проверками на `null`/`undefined`
- `movies.slice()` защищен проверкой `(movies || [])`

### 2. Защита индексов
- Добавлена проверка `currentMovieIndex < movies.length` перед доступом к элементу массива
- Использован `Math.max(0, ...)` для предотвращения отрицательных значений

### 3. Инициализация массивов
- `loadMatches` теперь всегда устанавливает массив (пустой при ошибке)
- `loadAvailableRooms` проверяет, что результат - массив
- `loadMovies` проверяет тип данных перед установкой

### 4. Защита в WebSocket
- `setMatches` в `onMatch` проверяет, что `prev` не `null`

## Что нужно сделать

### 1. Пересобрать frontend

```bash
cd /Users/maksimzagorodnev/Downloads/kinoswipe
docker-compose build frontend
docker-compose up -d frontend
```

### 2. Очистить кеш браузера

**Важно!** Очистите кеш браузера:
- **Chrome/Safari**: `Cmd + Shift + R` (Mac) или `Ctrl + Shift + R` (Windows)
- Или откройте в режиме инкогнито

### 3. Проверить работу

1. Откройте `http://localhost:3000`
2. Войдите в систему
3. Создайте комнату или присоединитесь к существующей
4. Проверьте, что фильмы загружаются без ошибок

## Если ошибка сохраняется

### Проверьте логи frontend:
```bash
docker-compose logs frontend -f
```

### Проверьте консоль браузера:
1. Откройте Developer Tools (F12)
2. Перейдите на вкладку Console
3. Посмотрите на ошибки

### Полная перезагрузка:
```bash
docker-compose down
docker-compose build frontend
docker-compose up -d
```

## Измененные файлы

- `frontend/src/App.tsx` - добавлены проверки на `null`/`undefined` для всех массивов
