# –ì–æ—Ç–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å–ø–æ—Å–æ–± (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –æ–¥–∏–Ω —Å–∫—Ä–∏–ø—Ç:

```bash
cd /Users/maksimzagorodnev/Downloads/kinoswipe
./–ü–†–ò–ú–ï–ù–ò–¢–¨_–ò–ó–ú–ï–ù–ï–ù–ò–Ø.sh
```

---

## üìã –ü–æ—à–∞–≥–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã (–µ—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç):

### 1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞:

```bash
cd /Users/maksimzagorodnev/Downloads/kinoswipe
```

### 2. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:

```bash
docker-compose exec postgres psql -U kinoswipe -d kinoswipe -f /app/migrations/000002_add_premieres_and_auth.up.sql
```

–ò–ª–∏ –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ SQL:

```bash
docker-compose exec postgres psql -U kinoswipe -d kinoswipe <<EOF
ALTER TABLE users ADD COLUMN IF NOT EXISTS password_hash VARCHAR(255);

CREATE TABLE IF NOT EXISTS premieres (
    id UUID PRIMARY KEY,
    movie_id UUID,
    title VARCHAR(255) NOT NULL,
    description TEXT,
    poster_url TEXT,
    release_date TIMESTAMP,
    is_active BOOLEAN NOT NULL DEFAULT true,
    position VARCHAR(10) NOT NULL CHECK (position IN ('left', 'right')),
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (movie_id) REFERENCES movies(id) ON DELETE SET NULL
);

CREATE INDEX IF NOT EXISTS idx_premieres_is_active ON premieres(is_active);
CREATE INDEX IF NOT EXISTS idx_premieres_position ON premieres(position);
CREATE INDEX IF NOT EXISTS idx_premieres_release_date ON premieres(release_date);

CREATE TABLE IF NOT EXISTS match_links (
    id UUID PRIMARY KEY,
    match_id UUID NOT NULL,
    platform VARCHAR(50) NOT NULL,
    url TEXT NOT NULL,
    title VARCHAR(255) NOT NULL,
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (match_id) REFERENCES matches(id) ON DELETE CASCADE
);

CREATE INDEX IF NOT EXISTS idx_match_links_match_id ON match_links(match_id);
CREATE INDEX IF NOT EXISTS idx_match_links_platform ON match_links(platform);

CREATE TRIGGER update_premieres_updated_at BEFORE UPDATE ON premieres
    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();

CREATE TRIGGER update_match_links_updated_at BEFORE UPDATE ON match_links
    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();
EOF
```

### 3. –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤–æ–≥–æ –∞–¥–º–∏–Ω–∞:

```bash
docker-compose exec postgres psql -U kinoswipe -d kinoswipe <<EOF
INSERT INTO users (id, username, email, password_hash, user_type)
VALUES (
    gen_random_uuid(),
    'admin',
    'admin@kinoswipe.ru',
    '\$2a\$10\$N9qo8uLOickgx2ZMRZoMyeIjZAgcfl7p92ldGxad68LJZdL17lhWy',
    'admin'
)
ON CONFLICT (email) DO NOTHING;
EOF
```

**–î–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Ö–æ–¥–∞:**
- Email: `admin@kinoswipe.ru`
- –ü–∞—Ä–æ–ª—å: `admin123`

### 4. –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ backend:

```bash
docker-compose build app
```

### 5. –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ frontend:

```bash
docker-compose build frontend
```

### 6. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã:

```bash
docker-compose up -d
```

### 7. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å:

```bash
docker-compose ps
```

–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ —Å—Ç–∞—Ç—É—Å–µ "Up".

### 8. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

```bash
# –õ–æ–≥–∏ backend
docker-compose logs app -f

# –õ–æ–≥–∏ frontend
docker-compose logs frontend -f
```

---

## ‚úÖ –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥:

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä:** `http://localhost:3000`

2. **–û—á–∏—Å—Ç–∏—Ç–µ –∫–µ—à –±—Ä–∞—É–∑–µ—Ä–∞:**
   - Mac: `Cmd + Shift + R`
   - Windows: `Ctrl + Shift + R`
   - –ò–ª–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ –≤ —Ä–µ–∂–∏–º–µ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É:**
   - –ë—ã—Å—Ç—Ä—ã–π –≤—Ö–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç
   - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç (–Ω–æ backend handlers –Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å)
   - –ê–¥–º–∏–Ω-–≤—Ö–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç (–Ω–æ backend handlers –Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å)
   - –ë–æ–∫–æ–≤—ã–µ –ø–∞–Ω–µ–ª–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
   - –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–æ —Å—Å—ã–ª–∫–∞–º–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –º–∞—Ç—á–∞

---

## ‚ö†Ô∏è –í–ê–ñ–ù–û:

**Backend handlers –µ—â–µ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã!**

–î–ª—è –ø–æ–ª–Ω–æ–π —Ä–∞–±–æ—Ç—ã –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å:
- `handlers/auth_handler.go`
- `handlers/premiere_handler.go`
- `handlers/match_link_handler.go`
- `repository/premiere_repository.go`
- `repository/match_link_repository.go`

–°–º. –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –≤ —Ñ–∞–π–ª–µ `–ù–û–í–´–ï_–§–£–ù–ö–¶–ò–ò.md`

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–∏:

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã:

```bash
docker-compose exec postgres psql -U kinoswipe -d kinoswipe -c "\dt"
```

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ç–∞–±–ª–∏—Ü—ã:
- `premieres`
- `match_links`

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–¥–º–∏–Ω–∞:

```bash
docker-compose exec postgres psql -U kinoswipe -d kinoswipe -c "SELECT username, email, user_type FROM users WHERE user_type = 'admin';"
```

---

## üÜò –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ Docker:**
   ```bash
   docker ps
   ```

2. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Å–µ:**
   ```bash
   docker-compose down
   docker-compose up -d
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:**
   ```bash
   docker-compose logs -f
   ```

4. **–û—á–∏—Å—Ç–∏—Ç–µ –∏ –ø–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ:**
   ```bash
   docker-compose down
   docker-compose build --no-cache
   docker-compose up -d
   ```

---

**–ì–æ—Ç–æ–≤–æ! –í—Å–µ –∫–æ–º–∞–Ω–¥—ã –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üéâ**
