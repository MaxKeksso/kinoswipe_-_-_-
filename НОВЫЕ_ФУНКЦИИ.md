# –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

## ‚úÖ –ß—Ç–æ —É–∂–µ —Å–æ–∑–¥–∞–Ω–æ:

### 1. Backend –º–æ–¥–µ–ª–∏:
- `models/premiere.go` - –º–æ–¥–µ–ª—å –¥–ª—è –ø—Ä–µ–º—å–µ—Ä
- `models/auth.go` - –º–æ–¥–µ–ª–∏ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- `models/match_links.go` - –º–æ–¥–µ–ª—å –¥–ª—è —Å—Å—ã–ª–æ–∫ –ø–æ—Å–ª–µ –º–∞—Ç—á–∞
- `migrations/000002_add_premieres_and_auth.up.sql` - –º–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è –Ω–æ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü

### 2. Frontend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- `components/AuthForm.tsx` - —Ñ–æ—Ä–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏/–∞–¥–º–∏–Ω-–≤—Ö–æ–¥–∞
- `components/PremiereSidebar.tsx` - –±–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å –¥–ª—è –ø—Ä–µ–º—å–µ—Ä
- `components/MatchLinksPage.tsx` - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–æ —Å—Å—ã–ª–∫–∞–º–∏ –ø–æ—Å–ª–µ –º–∞—Ç—á–∞
- –û–±–Ω–æ–≤–ª–µ–Ω `api/api.ts` - –¥–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

## üìã –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ:

### 1. Backend handlers (–Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å):

#### handlers/premiere_handler.go
```go
package handlers

import (
    "encoding/json"
    "net/http"
    "kinoswipe/models"
    "kinoswipe/repository"
    "github.com/google/uuid"
    "github.com/gorilla/mux"
)

type PremiereHandler struct {
    premiereRepo *repository.PremiereRepository
}

func (h *PremiereHandler) GetPremieres(w http.ResponseWriter, r *http.Request) {
    // –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–µ–º—å–µ—Ä—ã —Å —Ñ–∏–ª—å—Ç—Ä–æ–º –ø–æ position
    // GET /api/v1/premieres?position=left
}

func (h *PremiereHandler) CreatePremiere(w http.ResponseWriter, r *http.Request) {
    // –°–æ–∑–¥–∞—Ç—å –ø—Ä–µ–º—å–µ—Ä—É (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
    // POST /api/v1/premieres
}

func (h *PremiereHandler) UpdatePremiere(w http.ResponseWriter, r *http.Request) {
    // –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–µ–º—å–µ—Ä—É (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
    // PUT /api/v1/premieres/{id}
}

func (h *PremiereHandler) DeletePremiere(w http.ResponseWriter, r *http.Request) {
    // –£–¥–∞–ª–∏—Ç—å –ø—Ä–µ–º—å–µ—Ä—É (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
    // DELETE /api/v1/premieres/{id}
}
```

#### handlers/auth_handler.go
```go
package handlers

import (
    "encoding/json"
    "net/http"
    "golang.org/x/crypto/bcrypt"
    "kinoswipe/models"
    "kinoswipe/repository"
)

type AuthHandler struct {
    userRepo *repository.UserRepository
}

func (h *AuthHandler) Register(w http.ResponseWriter, r *http.Request) {
    // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    // POST /api/v1/auth/register
    // { username, email, password, phone? }
}

func (h *AuthHandler) Login(w http.ResponseWriter, r *http.Request) {
    // –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (–æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–ª–∏ –∞–¥–º–∏–Ω)
    // POST /api/v1/auth/login
    // { email, password }
}
```

#### handlers/match_link_handler.go
```go
package handlers

import (
    "encoding/json"
    "net/http"
    "kinoswipe/models"
    "kinoswipe/repository"
    "github.com/google/uuid"
    "github.com/gorilla/mux"
)

type MatchLinkHandler struct {
    linkRepo *repository.MatchLinkRepository
}

func (h *MatchLinkHandler) GetMatchLinks(w http.ResponseWriter, r *http.Request) {
    // –ü–æ–ª—É—á–∏—Ç—å —Å—Å—ã–ª–∫–∏ –¥–ª—è –º–∞—Ç—á–∞
    // GET /api/v1/matches/{match_id}/links
}

func (h *MatchLinkHandler) CreateMatchLink(w http.ResponseWriter, r *http.Request) {
    // –°–æ–∑–¥–∞—Ç—å —Å—Å—ã–ª–∫—É –¥–ª—è –º–∞—Ç—á–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
    // POST /api/v1/matches/{match_id}/links
}
```

### 2. Repository (–Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å):

#### repository/premiere_repository.go
```go
package repository

import (
    "database/sql"
    "kinoswipe/models"
    "github.com/google/uuid"
)

type PremiereRepository struct {
    db *sql.DB
}

func (r *PremiereRepository) GetAll(position *string) ([]*models.Premiere, error) {
    // –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–µ–º—å–µ—Ä—ã
}

func (r *PremiereRepository) Create(premiere *models.Premiere) error {
    // –°–æ–∑–¥–∞—Ç—å –ø—Ä–µ–º—å–µ—Ä—É
}

func (r *PremiereRepository) Update(id uuid.UUID, premiere *models.UpdatePremiereRequest) error {
    // –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–µ–º—å–µ—Ä—É
}

func (r *PremiereRepository) Delete(id uuid.UUID) error {
    // –£–¥–∞–ª–∏—Ç—å –ø—Ä–µ–º—å–µ—Ä—É
}
```

#### repository/match_link_repository.go
```go
package repository

import (
    "database/sql"
    "kinoswipe/models"
    "github.com/google/uuid"
)

type MatchLinkRepository struct {
    db *sql.DB
}

func (r *MatchLinkRepository) GetByMatchID(matchID uuid.UUID) ([]*models.MatchLink, error) {
    // –ü–æ–ª—É—á–∏—Ç—å —Å—Å—ã–ª–∫–∏ –¥–ª—è –º–∞—Ç—á–∞
}

func (r *MatchLinkRepository) Create(link *models.MatchLink) error {
    // –°–æ–∑–¥–∞—Ç—å —Å—Å—ã–ª–∫—É
}
```

### 3. Frontend - –æ–±–Ω–æ–≤–∏—Ç—å App.tsx:

1. –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è –ø—Ä–µ–º—å–µ—Ä
2. –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è —Ä–µ–∂–∏–º–∞ –∞–¥–º–∏–Ω–∞
3. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å AuthForm –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
4. –î–æ–±–∞–≤–∏—Ç—å PremiereSidebar –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—ã–±–æ—Ä–∞ –∫–æ–º–Ω–∞—Ç—ã
5. –û–±–Ω–æ–≤–∏—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –º–∞—Ç—á–∞ –¥–ª—è –ø–æ–∫–∞–∑–∞ MatchLinksPage

### 4. –°–æ–∑–¥–∞—Ç—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å:

#### components/AdminPanel.tsx
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–º—å–µ—Ä–∞–º–∏ (CRUD)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∞–º–∏ –¥–ª—è –º–∞—Ç—á–µ–π
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç:

### 1. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é:
```bash
docker-compose exec postgres psql -U kinoswipe -d kinoswipe -f /app/migrations/000002_add_premieres_and_auth.up.sql
```

–ò–ª–∏ —á–µ—Ä–µ–∑ migrate:
```bash
docker-compose run --rm migrate -path /migrations -database "postgres://kinoswipe:kinoswipe123@postgres:5432/kinoswipe?sslmode=disable" up
```

### 2. –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤–æ–≥–æ –∞–¥–º–∏–Ω–∞:
```sql
INSERT INTO users (id, username, email, password_hash, user_type)
VALUES (
    gen_random_uuid(),
    'admin',
    'admin@kinoswipe.ru',
    '$2a$10$...', -- —Ö–µ—à –ø–∞—Ä–æ–ª—è (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ bcrypt)
    'admin'
);
```

### 3. –û–±–Ω–æ–≤–∏—Ç—å routes –≤ main.go:
```go
// Auth routes
api.HandleFunc("/auth/register", authHandler.Register).Methods("POST")
api.HandleFunc("/auth/login", authHandler.Login).Methods("POST")

// Premiere routes (–∑–∞—â–∏—Ç–∏—Ç—å middleware –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
api.HandleFunc("/premieres", premiereHandler.GetPremieres).Methods("GET")
api.HandleFunc("/premieres", premiereHandler.CreatePremiere).Methods("POST")
api.HandleFunc("/premieres/{id}", premiereHandler.UpdatePremiere).Methods("PUT")
api.HandleFunc("/premieres/{id}", premiereHandler.DeletePremiere).Methods("DELETE")

// Match links routes
api.HandleFunc("/matches/{match_id}/links", matchLinkHandler.GetMatchLinks).Methods("GET")
api.HandleFunc("/matches/{match_id}/links", matchLinkHandler.CreateMatchLink).Methods("POST")
```

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è:

1. –î–ª—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `golang.org/x/crypto/bcrypt`
2. –î–ª—è –∑–∞—â–∏—Ç—ã –∞–¥–º–∏–Ω—Å–∫–∏—Ö —Ä–æ—É—Ç–æ–≤ —Å–æ–∑–¥–∞–π—Ç–µ middleware –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ user_type === "admin"
3. –ë–æ–∫–æ–≤—ã–µ –ø–∞–Ω–µ–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –≤—ã–±–æ—Ä–∞ –∫–æ–º–Ω–∞—Ç—ã
4. –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–æ —Å—Å—ã–ª–∫–∞–º–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –º–∞—Ç—á–∞ –≤–º–µ—Å—Ç–æ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:

- –í—Å–µ –ø–∞—Ä–æ–ª–∏ –¥–æ–ª–∂–Ω—ã —Ö–µ—à–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å –ø–æ–º–æ—â—å—é bcrypt
- –ê–¥–º–∏–Ω—Å–∫–∏–µ —Ä–æ—É—Ç—ã –¥–æ–ª–∂–Ω—ã –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ó–∞—â–∏—Ç–∞ –æ—Ç SQL –∏–Ω—ä–µ–∫—Ü–∏–π (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã)
