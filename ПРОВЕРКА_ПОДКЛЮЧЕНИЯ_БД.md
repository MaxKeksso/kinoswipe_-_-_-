# Как проверить, что приложение подключилось к PostgreSQL

## 1. Проверка из терминала (psql)

Подключитесь к базе под пользователем `kinoswipe`:

```bash
psql -h localhost -p 5432 -U kinoswipe -d kinoswipe
```

Пароль: `kinoswipe123`

- Если зашли и видите приглашение `kinoswipe=#` — пользователь и база есть, подключение работает.
- Посмотреть таблицы: `\dt`
- Выйти: `\q`

---

## 2. Проверка скриптом (без запуска приложения)

Из корня проекта:

```bash
cd /Users/maksimzagorodnev/Downloads/kinoswipe
# В .env должна быть строка DATABASE_URL=postgres://kinoswipe:...
go run -tags createadmin ./scripts/
```

- Увидели **«✅ Администратор создан!»** или **«✅ Администратор обновлен!»** — подключение к БД есть, скрипт записал данные.
- Увидели **«Failed to ping database»** — к БД подключиться не удалось (проверьте хост, порт, пользователя, пароль и что PostgreSQL запущен).

---

## 3. Проверка приложением (backend)

Запустите сервер:

```bash
cd /Users/maksimzagorodnev/Downloads/kinoswipe
go run cmd/server/main.go
```

- В логе есть строка **«Database connection established successfully»** и потом **「Server starting on ...」** — приложение подключилось к БД.
- Если сразу вылетает с **「Failed to connect to database」** — подключения нет (проверьте `.env` и что БД доступна).

Проверка через API (когда сервер уже запущен):

```bash
curl http://localhost:8080/api/v1/health
```

Ответ `OK` значит, что сервер и БД работают.

---

## 4. Проверка в самой PostgreSQL (что таблицы созданы)

После миграций зайдите в базу:

```bash
psql -h localhost -p 5432 -U kinoswipe -d kinoswipe -c "\dt"
```

Должны быть таблицы: `users`, `rooms`, `movies`, `swipes`, `matches`, `premieres` и др. Если их нет — миграции не применялись, выполните:

```bash
export DATABASE_URL="postgres://kinoswipe:kinoswipe123@localhost:5432/kinoswipe?sslmode=disable"
migrate -path ./migrations -database "$DATABASE_URL" up
```

---

## Кратко

| Способ | Команда / Действие | Что значит успех |
|--------|---------------------|------------------|
| psql   | `psql -h localhost -p 5432 -U kinoswipe -d kinoswipe` | Вошли в базу |
| Скрипт | `go run -tags createadmin ./scripts/` | Сообщение «✅ Администратор создан/обновлен» |
| Сервер | `go run cmd/server/main.go` | В логе: «Database connection established successfully» |
| API    | `curl http://localhost:8080/api/v1/health` | Ответ `OK` |

Если все четыре способа проходят — приложение подключено к вашей PostgreSQL и с ней можно работать.
